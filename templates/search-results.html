{% extends 'base.html' %}
{% block body %}

{% if name is not none %}


    <h3>{{ name }}</h3> 
      {% for photo_id, url, photo, saved in image_urls %}
        <a href="/photo-info/{{ photo_id}}">
        <img src="{{ photo }}" class="search-result" id="{{ photo_id }}">
        <a href="{{ url }}">Photo Source</a><br>
        </a>
        {% if saved == 'like' %}
          <button type="button" class='like' value="{{ photo_id }}" imageurl="{{ url }}">Like</button><br>
        {% elif saved == 'unlike' %}
          <button type="button" class="unlike" value="{{ photo_id }}" imageurl="{{ url }}">Unlike</button><br><br>
        {% endif %}
      {% endfor %}

<script>
    function likeButton(someButton) {
        console.log(someButton);
        someButton.text("unlike");


    }
    function savePic(evt) {
        console.log("test..............................")
      
        // console.log(searchResult);
        var thisButton = $(this);
        var imageUrl = thisButton.attr('imageurl');

        var searchResult = {
            "src": $("img.search-result").attr("src"),
            "id": $(this).attr("value")
        };

        $.post("/save-pic",
               searchResult,
               likeButton(thisButton)
               );
        // console.log($(this));
        }
      console.log('hello');
     $("button.like").on("click", savePic);

  function unLikeButton() {
    $("button.unlike").replaceWith('<button type="button" class="like">Like</button>');
    $("button.like").on("click", savePic)
  }
  function removePic(evt) {
    // console.log('in removePic function')
    var thisButton = $(this);
        var imageUrl = thisButton.attr('imageurl');
    var searchResult = {
            "src": $("img.search-result").attr("src"),
            "id": $(this).attr("value")
    };
    $.post("/remove-pic",
           searchResult,
           unLikeButton(thisButton)
           );
  }
  $("button.unlike").on("click", removePic)
  </script>
{% else %}
  <h3> Sorry, {{ search }} did not return any results. Please try another search.</h3>
{% endif %}
{% endblock %}